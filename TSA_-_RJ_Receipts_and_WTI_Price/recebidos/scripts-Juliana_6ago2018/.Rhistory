out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE) next
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
cat("Nome da aba: ", sheetNames[i])
cat("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
cat("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
print(cat("Nome da aba: ", sheetNames[i]))
cat("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
cat("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
message(cat("Nome da aba: ", sheetNames[i]))
message("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
message("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
warnings()
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
message(paste("Nome da aba: ", sheetNames[i]))
message("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
message("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
message(cat("Nome da aba: ", sheetNames[i]))
message(cat("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F)))
message(cat("comCedae: ", comCedae))
next
}
flush.console()
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
message(cat("Nome da aba: ", sheetNames[i]))
message(cat("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F)))
message(cat("comCedae: ", comCedae))
flush.console()
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
Sys.sleep(0.1)
message(cat("Nome da aba: ", sheetNames[i]))
message(cat("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F)))
message(cat("comCedae: ", comCedae))
flush.console()
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
Sys.sleep(0.1)
print("Nome da aba: ", sheetNames[i])
print("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
print("comCedae: ", comCedae)
flush.console()
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
print("Nome da aba: ", sheetNames[i])
print("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
print("comCedae: ", comCedae)
flush.console()
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
flush.console()
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
print("Nome da aba: ", sheetNames[i])
print("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
print("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
#select(-c(Col1, Col2, Col15:ncol(.)))
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R', echo=TRUE)
source('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
print("Nome da aba: ", sheetNames[i])
print("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
print("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R', echo=TRUE)
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
source()
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
View(criarSerieRJ)
View(criarSerieRJ)
debugSource('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
print("Nome da aba: ", sheetNames[i])
print("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
print("comCedae: ", comCedae)
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
criarSerieRJ <- function(yearStart = 2001, yearEnd = 2017, comCedae = TRUE) {
dadosReceitaRJ <- loadWorkbook("serie_historica_ate_2017.xls")
sheetNames <- getSheets(dadosReceitaRJ)
numSheets <- length(excel_sheets("serie_historica_ate_2017.xls"))
out <- data.frame(matrix(ncol = 0, nrow = 0))
currentYear <- yearStart
#currentYear <- 2001
for (i in 1:numSheets) {
#implementando verificação pelo nome da aba
#se tem 'com ...' e não quero cedae... next
if(grepl("com", sheetNames[i], ignore.case = F) && comCedae == FALSE){
print("Nome da aba: ", sheetNames[i])
print("Tem 'com' no nome: ", grepl("com", sheetNames[i], ignore.case = F))
print("comCedae: ", comCedae)
browser()
next
}
receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = i) %>%
#receitaAnoRj <- readWorksheet(dadosReceitaRJ, sheet = 8) %>%
#filter(Col1 == "Total Geral" ) %>%
filter(.[,1] == "Total Geral" ) %>%
select(-c(1, 2, 15:ncol(.)))
#populando saída
df <- data.frame(matrix(nrow = 12, ncol = 2))
mesAno <- c()
for (j in 1:12) mesAno <- c(mesAno, paste(j,'/', currentYear, ' ' ,sheetNames[i], sep = ''))
receita <- as.numeric(as.vector(receitaAnoRj[1,]))
df <- cbind( mesAno, receita)
out <- rbind(out, df)
currentYear = currentYear + 1
if(currentYear > yearEnd) break
}
out
}
df <- criarSerieRJ(yearStart = 2001, yearEnd = 2017, comCedae = TRUE)
source('~/Drive/Mestrado/scripts-Juliana_6ago2018/debug.R')
