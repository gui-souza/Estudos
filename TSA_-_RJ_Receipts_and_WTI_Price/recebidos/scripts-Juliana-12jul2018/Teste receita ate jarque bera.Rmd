---
title: "RECEITA_BRUTA"
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library("tseries")
library("ggplot2")
library("forecast")
library("foreign")
library("quantmod")
library("urca")
```

#Juliana:
Estou tentando verificar qual o impacto do preço do petróleo nas contas do Estado do RJ, analisando o período de 2001 (a partir da LRF) a 2017. Pra começar minha análise, preciso rodar algumas regressões. Primeiro, com a receita bruta do RJ (que segue em anexo), rodando receita contra receita (R, R -1, R -2, e assim por diante). Preciso testar quais combinações de receitas vão dar o melhor R2, de preferência com o menos numero de variáveis possível.

Mas antes da regressão, preciso fazer alguns testes com a série: teste de normalidade e de estacionaridade (se a série não for estacionária, vou ter que fazer um teste de cointegração pra trabalhar ela em nível).

O Ariel me falou de alguns pacotes do R pra fazer esses teste:

- urca (pra fazer o teste jarquebera) e foreing - normalidade
- tseries, tstudio e tidy.quanti - pra transformar a série numa série temporal
- teste de chow - quebra de série 
- Pra testar a estacionaridade e fazer a cointegração tenho que pesquisa qual o melhor pacote, não sei ainda.
- Ah e preciso fazer tudo no RMarkdown.

#Ariel:
- é uma regressão simples
- tem tudo no Larosse também

Envolve:
- Regressão de séries temporais, 
- Teste de estacionariedade, 
- Se não for estacionária  trabalha com o log retorno

A ideia é simples: Receita do RJ ~ preço do petróleo internacional + câmbio + delta PIB (Na verdade o que interessa é o primeiro). Assim ... derrocada no preço do petróleo -> o gestor público já pode antecipar e contingenciar despesas, conforme LRF E mostrar que poderíamos ter minimizado a crise se isso tivesse sido feito.

Importando do Excel os dados mensais de receita bruta do Estado do Rio de Janeiro:

```{r}
RECEITA_RJ <- read_excel("RECEITA_RJ.xlsx", sheet = "Plan1")
```


Avisar ao R que se trata de uma s?rie de tempo com frequ?ncia mensal e in?cio em jan/2001:

```{r}
series<- ts(RECEITA_RJ, start = c(2001, 1), frequency = 12)
```

Visualizando os dados ao longo do tempo:

```{r}
plot(series)
```


```{r}
plot(series, col='blue', main = 'Comportamento dados', xlab = 'M?s/ano')
```


Estat?stica b?sica:

```{r}
summary(series) 
```

A proximidade dos valores de m?dia e mediana sugere uma normalidade dos dados.

```{r}
qqplot(series)
```

?qqplot

```{r}
jarque.bera.test(series)


qqq <- function(series, ref.line=TRUE, distr=qnorm, param=list(mean=0, sd=1)){
  x <- na.omit(series)               
  xo <- sort(series)                
  n <- length(series)                
  i <- seq_along(series)             
  pteo <- (i-0.5)/n             
  qteo <- do.call(distr,        
                  c(list(p=pteo), param))
  plot(xo~qteo)                 
  if(ref.line){
    qrto <- quantile(series, c(1,3)/4) 
    qrtt <- do.call(distr,        
                    c(list(p=c(1,3)/4), param))
    points(qrtt, qrto, pch=3)      
    b <- diff(qrto)/diff(qrtt)    
    a <- b*(0-qrtt[1])+qrto[1]    
    abline(a=a, b=b)              
  }
}
 
series <- rnorm(20)
par(mfrow=c(1,2))
qqq(series)
qqnorm(series); qqline(series)
layout(1)
 
series <- runif(20)
qqq(series, ref.line=TRUE, distr=qunif, param=list(min=0, max=1))
 
x <- rgamma(20, shape=4, rate=1/2)
qqq(x, ref.line=TRUE, distr=qgamma, param=list(shape=4, rate=1/2))

```